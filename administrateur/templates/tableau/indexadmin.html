{% load static %}
<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="{% static 'tableau/style.css' %}">
    <style>
        .hidden {
            display: none;
        }
        
           
            
        
        .imge{
            position:relative; left:70px;
            border-radius:50%;justify-content: center;align-items: center;
        }
        body{
            background-color: white;
            background-image: url("{% static 'images/logoapp.jpg' %}");
            background-size: 400px 200px;
            background-position:center;
        }
    </style>
</head>

<body>
    
    

    
    <div class="grid-container">

       
        <header class="header">
            <div class="menu-icon">
                <span class="material-icons-outlined" id="menu-icon">
                    menu
                </span>
            </div>
            <div class="header-left">
                <span class="material-icons-outlined" id="search-icon">
                
                </span>
            </div>
            <div class="header-right">
                <span class="material-icons-outlined" id="notifications-icon">
                    notifications
                </span>
                <span class="material-icons-outlined" id="email-icon">
                    email
                </span>
                <span class="material-icons-outlined" id="account-icon">
                    account_circle
                </span>
            </div>
        </header>

        <aside id="sidebar">
            <div class="sidebar-brand">
                <div class="sidebar-title">
                    
                </div>
            </div>

            <style>
                #sidebar{
                    background:rgb(46, 42, 42);
                }
            </style>

            <div class="imge">
                <img src="/static/images/logoapp.png" width ="100px">
            </div>

            <ul class="sidebar-list">
                <li class="sidebar-list-item" data-content="eleves">
                    <span title="Gérer les élèves" class="material-icons-outlined">
                        people
                    </span>
                    <span class="label-item">Gérer les élèves</span>
                </li>
                <li class="sidebar-list-item" data-content="parents">
                    <span title="Gérer les parents" class="material-icons-outlined">
                        people
                    </span>
                    <span class="label-item">Gérer les parents</span>
                </li>
                <li class="sidebar-list-item" data-content="enseignants">
                    <span title="Gérer les enseignants" class="material-icons-outlined">
                        people
                    </span>
                    <span class="label-item">Gérer les enseignants</span>
                </li>
                <li class="sidebar-list-item" data-content="salles">
                    <span title="Gérer les salles de classe" class="material-icons-outlined">
                        meeting_room
                    </span>
                    <span class="label-item">Gérer les salles</span>
                </li>
                <li class="sidebar-list-item" data-content="matieres">
                    <span title="Gestion matieres" class="material-icons-outlined">
                        subject
                    </span>
                    <span class="label-item">Gerer les Matieres</span>
                </li>
                <li class="sidebar-list-item" data-content="notes">
                    <span title="Gérer les notes" class="material-icons-outlined">
                        grade
                    </span>
                    <span class="label-item">Gérer les notes</span>
                </li>
                <li class="sidebar-list-item" data-content="emploie">
                    <span title="Gérer les emploies de temps" class="material-icons-outlined">
                        grade
                    </span>
                    <span class="label-item">Gérer les emploies de temps</span>
                </li>
                <li class="sidebar-list-item" data-content="assiduite">
                    <span title="Gérer l'assiduité" class="material-icons-outlined">
                        check_circle
                    </span>
                    <span class="label-item">Gérer l'assiduité</span>
                </li>
                <li class="sidebar-list-item" data-content="statistiques">
                    <span title="Consulter les statistiques" class="material-icons-outlined">
                        bar_chart
                    </span>
                    <span class="label-item">Consulter les statistiques</span>
                </li>
                <li class="sidebar-list-item" data-content="deconnexion">
                    <span title="Déconnexion" class="material-icons-outlined">
                        logout
                    </span>
                    <span class="label-item">Déconnexion</span>
                </li>
            </ul>
        </aside>

        <main class="main-container" id="main-content">
            <div class="main-title">
                <p class="fw-600">Dashboard</p>
            </div>
        </main>
    </div>


    <script>
       document.addEventListener('DOMContentLoaded', function () {
    const sidebarItems = document.querySelectorAll('.sidebar-list-item');
    const mainContent = document.getElementById('main-content');

    sidebarItems.forEach(item => {
        item.addEventListener('click', () => {
            const content = item.getAttribute('data-content');
            let contentHtml = '';

            switch (content) {
                case 'notes':
                    contentHtml = `
                        <div class="main-title">
                            <p class="fw-600">emploie</p>
                        </div>
                        <p>Affichage des notes.</p>`;
                    break;
                    case 'emploie':
                    contentHtml = `
                        <div class="main-title">
                            <p class="fw-600">EMPLOIE DE TEMP</p>
                        </div>
                      <div id="form-container">
    <form id="emploi-form" method="post" action="{% url 'emploi_temps_view' %}">
        <div class="mb-4">
            <label for="niveau" class="block text-sm font-medium text-gray-700">Niveau</label>
             <select id="niveau" name="niveau" class="mt-1 block w-md pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">
            {% for niveau in niveaux %}
              <option value="{{ niveau.id }}">{{ niveau.nom }}</option>
               {% endfor %}
              </select>
             </div>

        <div class="mb-4">
            <label for="salle" class="block text-sm font-medium text-gray-700">Salle</label>
            <select id="salle" name="salle" class="mt-1 block w-md pl-3 pr-10 py-2 border-gray-300 rounded-md">
                <option value="">Sélectionnez une salle</option>
            </select>
      
        <div class="flex space-x-4">
            <button type="submit" id="submit-emploi" class="bg-blue-500 text-white font-bold py-2 px-4 rounded">Soumettre</button>
            <button type="button" id="cancel-emploi" class="bg-gray-500 text-white font-bold py-2 px-4 rounded">Annuler</button>
        </div>
        {% csrf_token %}
    </form>
</div>
<div id="emploi-table-container"></div>


`;
                    break;


                case 'parents':
                    contentHtml = `
                        <div class="main-title">
                            <p class="fw-600">Parents</p>
                        </div>
                        <!-- Formulaire pour la gestion des parents -->
                          <div class="flex justify-between mb-4">
    <div>
        <button id="open-modal" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
            <span class="material-icons-outlined align-middle">add_circle</span>
            Ajouter
        </button>
    </div>
    <div>
        <input type="text" id="search" placeholder="Rechercher..." class="px-4 py-2 border rounded-md">
    </div>
</div>

<div class="overflow-x-auto" id="table-container">
    <table id="data-table" class="min-w-full bg-white rounded-lg shadow-md overflow-hidden">
        <thead class="bg-gray-200 text-gray-600 text-sm leading-normal">
            <tr>
                <th class="py-3 px-6 text-left">ID</th>
                <th class="py-3 px-6 text-left">Nom</th>
                <th class="py-3 px-6 text-left">Prénoms</th>
                <th class="py-3 px-6 text-left">Sexe</th>
                <th class="py-3 px-6 text-left">Téléphone</th>
                <th class="py-3 px-6 text-left">Email</th>
                <th class="py-3 px-6 text-left">Profession</th>
                <th class="py-3 px-6 text-left">Nombre d'enfant</th>
                <th class="py-3 px-6 text-center">Action</th>
            </tr>
        </thead>
        <tbody id="table-body" class="text-gray-600 text-sm font-light">
           {% for parent in liste_parent %}
            <tr>
                <td>{{ parent.id }}</td>
                <td>{{ parent.username }}</td>
                <td>{{ parent.prenom }}</td>
                <td>{{ parent.sexe }}</td>
                <td>{{ parent.numero_tel }}</td>
                <td>{{ parent.email }}</td>
                <td>{{ parent.profession }}</td>
                 <td>{{ parent.nombres_enfants }}</td>
                <td class="text-center">
                    <button class="text-yellow-500 hover:text-yellow-700" onclick="editParent({{ enseignant.id }})">
                        <span class="material-icons-outlined">edit</span>
                    </button>
                    <button class="text-red-500 hover:text-red-700 ml-2" onclick="deleteParent({{ enseignant.id }})">
                        <span class="material-icons-outlined">delete</span>
                    </button>
                </td>
            </tr>
              {% endfor %}
        </tbody>
    </table>
</div>


                        <div id="modal-form" class="inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center hidden z-50 absolute">
                            <div class="bg-white p-6 rounded-lg shadow-lg w-96">
                                <h2 class="text-2xl font-bold mb-4">Ajouter un parent</h2>
                                <form id="add-parent-form" method="POST" action="{% url 'addparent' %}">
                                    {% csrf_token %}
                                    <div class="mb-4">
                                        <label for="input-nom" class="block text-sm font-bold mb-2">Nom:</label>
                                        <input type="text" id="input-nom" name="noms" class="w-full px-4 py-2 border rounded-md" required>
                                    </div>
                                    <div class="mb-4">
                                        <label for="input-prenom" class="block text-sm font-bold mb-2">Prénoms:</label>
                                        <input type="text" id="input-prenom" name="prenom" class="w-full px-4 py-2 border rounded-md" required>
                                    </div>
                                    <div class="mb-4">
                                        <label for="input-sexe" class="block text-sm font-bold mb-2">Sexe:</label>
                                        <input type="text" id="input-sexe" name="sexe" class="w-full px-4 py-2 border rounded-md" required>
                                    </div>
                                    <div class="mb-4">
                                        <label for="input-telephone" class="block text-sm font-bold mb-2">Téléphone:</label>
                                        <input type="text" id="input-telephone" name="telephone" class="w-full px-4 py-2 border rounded-md" required>
                                    </div>
                                    <div class="mb-4">
                                        <label for="input-email" class="block text-sm font-bold mb-2">Email:</label>
                                        <input type="email" id="input-email" name="email" class="w-full px-4 py-2 border rounded-md" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="input-profession" class="block text-sm font-bold mb-2">Profession :</label>
                                        <input type="text" id="input-profession" name="profession" class="w-full px-4 py-2 border rounded-md" required>
                                    </div>
                                    <div class="mb-4">
                                        <label for="input-" class="block text-sm font-bold mb-2">Niveau:</label>
                                        <input type="text" id="input-nombres_enfants" name="nombres_enfants" class="w-full px-4 py-2 border rounded-md" required>
                                    </div>
                                    <div class="flex justify-end">
                                        <button type="button" id="close-modal" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded mr-2">Annuler</button>
                                        <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Ajouter</button>
                                    </div>
                                </form>
                            </div>
                        </div>`;
                    break;
                case 'enseignants':
                    contentHtml = `
                        <div class="main-title">
                            <p class="fw-600">Enseignants</p>
                        </div>
                       <div class="flex justify-between mb-4">
    <div>
        <button id="open-modal" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
            <span class="material-icons-outlined align-middle">add_circle</span>
            Ajouter
        </button>
    </div>
    <div>
        <input type="text" id="search" placeholder="Rechercher..." class="px-4 py-2 border rounded-md">
    </div>
</div>

<div class="overflow-x-auto" id="table-container">
    <table id="data-table" class="min-w-full bg-white rounded-lg shadow-md overflow-hidden">
        <thead class="bg-gray-200 text-gray-600 text-sm leading-normal">
            <tr>
                <th class="py-3 px-6 text-left">ID</th>
                <th class="py-3 px-6 text-left">Nom</th>
                <th class="py-3 px-6 text-left">Prénoms</th>
                <th class="py-3 px-6 text-left">Sexe</th>
                <th class="py-3 px-6 text-left">Téléphone</th>
                <th class="py-3 px-6 text-left">Email</th>
                <th class="py-3 px-6 text-left">Matière enseignée</th>
                <th class="py-3 px-6 text-left">niveau</th>
                <th class="py-3 px-6 text-left">Date d'enregistrement</th>
                <th class="py-3 px-6 text-center">Action</th>
            </tr>
        </thead>
        <tbody id="table-body" class="text-gray-600 text-sm font-light">
           {% for enseignant in liste_enseignant %}
            <tr>
                <td>{{ enseignant.id }}</td>
                <td>{{ enseignant.username }}</td>
                <td>{{ enseignant.prenom }}</td>
                <td>{{ enseignant.sexe }}</td>
                <td>{{ enseignant.numero_tel }}</td>
                <td>{{ enseignant.email }}</td>
                <td>{{ enseignant.matiere }}</td>
                 <td>{{ enseignant.niveau }}</td>
                <td>{{ enseignant.date_enregistrement }}</td>
                <td class="text-center">
                    <button class="text-yellow-500 hover:text-yellow-700" onclick="editEnseignant({{ enseignant.id }})">
                        <span class="material-icons-outlined">edit</span>
                    </button>
                    <button class="text-red-500 hover:text-red-700 ml-2" onclick="deleteEnseignant({{ enseignant.id }})">
                        <span class="material-icons-outlined">delete</span>
                    </button>
                </td>
            </tr>
              {% endfor %}
        </tbody>
    </table>
</div>


                        <div id="modal-form" class="inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center hidden z-50 absolute">
                            <div class="bg-white p-6 rounded-lg shadow-lg w-96">
                                <h2 class="text-2xl font-bold mb-4">Ajouter un(e) enseignant(e)</h2>
                                <form id="add-enseignant-form" method="POST" action="{% url 'addenseignant' %}">
                                    {% csrf_token %}
                                    <div class="mb-4">
                                        <label for="input-nom" class="block text-sm font-bold mb-2">Nom:</label>
                                        <input type="text" id="input-nom" name="noms" class="w-full px-4 py-2 border rounded-md" required>
                                    </div>
                                    <div class="mb-4">
                                        <label for="input-prenom" class="block text-sm font-bold mb-2">Prénoms:</label>
                                        <input type="text" id="input-prenom" name="prenom" class="w-full px-4 py-2 border rounded-md" required>
                                    </div>
                                    <div class="mb-4">
                                        <label for="input-sexe" class="block text-sm font-bold mb-2">Sexe:</label>
                                        <input type="text" id="input-sexe" name="sexe" class="w-full px-4 py-2 border rounded-md" required>
                                    </div>
                                    <div class="mb-4">
                                        <label for="input-telephone" class="block text-sm font-bold mb-2">Téléphone:</label>
                                        <input type="text" id="input-telephone" name="telephone" class="w-full px-4 py-2 border rounded-md" required>
                                    </div>
                                    <div class="mb-4">
                                        <label for="input-email" class="block text-sm font-bold mb-2">Email:</label>
                                        <input type="email" id="input-email" name="email" class="w-full px-4 py-2 border rounded-md" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="input-matiere" class="block text-sm font-bold mb-2">Matière enseignée:</label>
                                        <input type="text" id="input-matiere" name="matiere" class="w-full px-4 py-2 border rounded-md" required>
                                    </div>
                                    <div class="mb-4">
                                        <label for="input-niveau" class="block text-sm font-bold mb-2">Niveau:</label>
                                        <input type="text" id="input-niveau" name="niveau" class="w-full px-4 py-2 border rounded-md" required>
                                    </div>
                                    <div class="flex justify-end">
                                        <button type="button" id="close-modal" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded mr-2">Annuler</button>
                                        <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Ajouter</button>
                                    </div>
                                </form>
                            </div>
                        </div>`;
                    break;
                    // code qui permet de gerer le formulaire et le tableau de la fonctionnamité de gestion des salles de classe
                    case 'salles':
    contentHtml = `
        <div class="main-title">
            <p class="fw-600">Salles</p>
        </div>
        <!-- Formulaire pour la gestion des salles -->
        <div class="flex justify-between mb-4">
            <div>
                <button id="open-modal" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                    <span class="material-icons-outlined align-middle">add_circle</span>
                    Ajouter
                </button>
            </div>
            <div>
                <input type="text" id="search" placeholder="Rechercher..." class="px-4 py-2 border rounded-md">
            </div>
        </div>

        <div class="overflow-x-auto" id="table-container" >
            <table id="data-table" class="min-w-full bg-white rounded-lg shadow-md overflow-hidden">
                <thead class="bg-gray-200 text-gray-600 text-sm leading-normal">
                    <tr>
                        <th class="py-3 px-6 text-left">ID</th>
                        <th class="py-3 px-6 text-left">Nom</th>
                        <th class="py-3 px-6 text-left">Localisation</th>
                        <th class="py-3 px-6 text-left">Effectifs</th>
                        <th class="py-3 px-6 text-center">Action</th>
                    </tr>
                </thead>
                <tbody id="table-body" class="text-gray-600 text-sm font-light">
                   {% for salle in liste_salle %}
                    <tr>
                        <td>{{ salle.id }}</td>
                        <td>{{ salle.nom }}</td>
                        <td>{{ salle.localisation }}</td>
                        <td>{{ salle.effectifs }}</td>
                        <td class="text-center">
                            <button class="text-yellow-500 hover:text-yellow-700" onclick="editSalle({{ salle.id }})">
                                <span class="material-icons-outlined">edit</span>
                            </button>
                            <button class="text-red-500 hover:text-red-700 ml-2" onclick="deleteSalle({{ salle.id }})">
                                <span class="material-icons-outlined">delete</span>
                            </button>
                        </td>
                    </tr>
                   {% endfor %}
                </tbody>
            </table>
        </div>

        <div id="modal-form" class="inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center hidden z-50 absolute">
            <div class="bg-white p-6 rounded-lg shadow-lg w-96">
                <h2 class="text-2xl font-bold mb-4">Ajouter une salle</h2>
                <form id="add-salle-form" method="POST" action="{% url 'addsalle' %}">
                    {% csrf_token %}
                    <div class="mb-4">
                        <label for="input-nom" class="block text-sm font-bold mb-2">Nom:</label>
                        <input type="text" id="input-nom" name="nom" class="w-full px-4 py-2 border rounded-md" required>
                    </div>
                    <div class="mb-4">
                        <label for="input-localisation" class="block text-sm font-bold mb-2">Localisation:</label>
                        <input type="text" id="input-localisation" name="localisation" class="w-full px-4 py-2 border rounded-md" required>
                    </div>
                    <div class="mb-4">
                        <label for="input-effectifs" class="block text-sm font-bold mb-2">Effectifs:</label>
                        <input type="text" id="input-effectifs" name="effectifs" class="w-full px-4 py-2 border rounded-md" >
                    </div>
                    <div class="flex justify-end">
                        <button type="button" id="close-modal" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded mr-2">Annuler</button>
                        <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Ajouter</button>
                    </div>
                </form>
            </div>
        </div>`;
    break;
    // code qui permet de gerer les matieres
    case 'matieres':
    contentHtml = `
        <div class="main-title">
            <p class="fw-600">matiere </p>
        </div>
         <!-- Formulaire pour la gestion des salles -->
        <div class="flex justify-between mb-4">
            <div>
                <button id="open-modal" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                    <span class="material-icons-outlined align-middle">add_circle</span>
                    Ajouter
                </button>
            </div>
            <div>
                <input type="text" id="search" placeholder="Rechercher..." class="px-4 py-2 border rounded-md">
            </div>
        </div>

        <div class="overflow-x-auto" id="table-container" >
            <table id="data-table" class="min-w-full bg-white rounded-lg shadow-md overflow-hidden">
                <thead class="bg-gray-200 text-gray-600 text-sm leading-normal">
                    <tr>
                        <th class="py-3 px-6 text-left">ID</th>
                        <th class="py-3 px-6 text-left">Nom</th>
                        <th class="py-3 px-6 text-left">Niveau</th>
                        <th class="py-3 px-6 text-left">COEFFICIENT</th>
                        <th class="py-3 px-6 text-center">Action</th>
                    </tr>
                </thead>
                <tbody id="table-body" class="text-gray-600 text-sm font-light">
                   {% for Matiere in liste_matiere %}
                    <tr>
                        <td>{{ matiere.id }}</td>
                        <td>{{ matiere.nom }}</td>
                        <td>{{ matiere.niveau }}</td>
                        <td>{{ matiere.coefficient }}</td>
                        <td class="text-center">
                            <button class="text-yellow-500 hover:text-yellow-700" onclick="editMatiere({{ matiere.id }})">
                                <span class="material-icons-outlined">edit</span>
                            </button>
                            <button class="text-red-500 hover:text-red-700 ml-2" onclick="deleteMatiere({{ matiere.id }})">
                                <span class="material-icons-outlined">delete</span>
                            </button>
                        </td>
                    </tr>
                   {% endfor %}
                </tbody>
            </table>
        </div>

        <div id="modal-form" class="inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center hidden z-50 absolute">
            <div class="bg-white p-6 rounded-lg shadow-lg w-96">
                <h2 class="text-2xl font-bold mb-4">Ajouter une matiere </h2>
                <form id="add-matiere-form" method="POST" action="{% url 'addmatiere' %}">
                    {% csrf_token %}
                    <div class="mb-4">
                        <label for="input-nom" class="block text-sm font-bold mb-2">Nom:</label>
                        <input type="text" id="input-nom" name="nom" class="w-full px-4 py-2 border rounded-md" required>
                    </div>
                    <div class="mb-4">
                                    <label for="niveau" class="block text-sm font-medium text-gray-700">Niveau</label>
                                    <select id="niveau" name="niveau" class="mt-1 block w-md pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">
                                        {% for niveau in niveaux %}
                                        <option value="{{ niveau.id }}">{{ niveau.nom }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                   <div class="mb-4">
                        <label for="input-coefficient" class="block text-sm font-bold mb-2">COEFFICIENT:</label>
                        <input type="text" id="input-coefficient" name="coefficient" class="w-full px-4 py-2 border rounded-md" required>
                    </div>
                    <div class="mb-4">
                                    <label for="enseignant" class="block text-sm font-medium text-gray-700">ENSEIGNANTS</label>
                                    <select id="enseignant" name="enseignant" class="mt-1 block w-md pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">
                                        {% for enseignant in enseignants %}
                                        <option value="{{ enseignant.id }}">{{ enseignant.nom }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                   
                    <div class="flex justify-end">
                        <button type="button" id="close-modal" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded mr-2">Annuler</button>
                        <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Ajouter</button>
                    </div>
                </form>
            </div>
        </div>`;
        break;
    // code qui permet de gerer le formulaire et le tableau de la fonctionnamité de gestion des eleves
    case 'eleves':
    contentHtml = `
        <div class="main-title">
            <p class="fw-600">eleves</p>
        </div>
        <!-- Formulaire pour la gestion des eleves -->
        <div class="flex justify-between mb-4">
            <div>
                <button id="open-modal" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                    <span class="material-icons-outlined align-middle">add_circle</span>
                    Ajouter
                </button>
            </div>
            <div>
                <input type="text" id="search" placeholder="Rechercher..." class="px-4 py-2 border rounded-md">
            </div>
        </div>
    <div class="overflow-x-auto" id="table-container">    
    <table id="data-table" class="min-w-full bg-white rounded-lg shadow-md overflow-hidden">
        <thead class="bg-gray-200 text-gray-600 text-sm leading-normal">
            <tr>
                <th class="py-3 px-6 text-left">ID</th>
                <th class="py-3 px-6 text-left">Nom</th>
                <th class="py-3 px-6 text-left">Prénoms</th>
                <th class="py-3 px-6 text-left">Date de Naissance</th>
                <th class="py-3 px-6 text-left">Sexe</th>
                <th class="py-3 px-6 text-left">Quartier</th>
                <th class="py-3 px-6 text-left">Classe</th>
                <th class="py-3 px-6 text-left">Téléphone Parent</th>
                <th class="py-3 px-6 text-center">Actions</th>
            </tr>
        </thead>
        <tbody id="table-body" class="text-gray-600 text-sm font-light">
            {% for eleve in liste_eleve %}
            <tr class="border-b border-gray-200 hover:bg-gray-100">
                <td class="py-3 px-6 text-left whitespace-nowrap">{{ eleve.id }}</td>
                <td class="py-3 px-6 text-left">{{ eleve.noms }}</td>
                <td class="py-3 px-6 text-left">{{ eleve.prenoms }}</td>
                <td class="py-3 px-6 text-left">{{ eleve.date_naissance }}</td>
                <td class="py-3 px-6 text-left">{{ eleve.sexe }}</td>
                <td class="py-3 px-6 text-left">{{ eleve.quartier }}</td>
                <td class="py-3 px-6 text-left">{{ eleve.salle.nom }}</td>
                <td class="py-3 px-6 text-left">{{ eleve.tel_parent }}</td>
                <td class="py-3 px-6 text-center">
                    <button class="text-yellow-500 hover:text-yellow-700" onclick="editEleve({{ eleve.id }})">
                        <span class="material-icons-outlined">edit</span>
                    </button>
                    <button class="text-red-500 hover:text-red-700 ml-2" onclick="deleteEleve({{ eleve.id }})">
                        <span class="material-icons-outlined">delete</span>
                    </button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>


        <div id="modal-form" class="inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center hidden z-50 absolute">
            <div class="bg-white p-6 rounded-lg shadow-lg w-96">
                <h2 class="text-2xl font-bold mb-4">Ajouter les eleves</h2>
                <form id="add-eleve-form" method="POST" action="{% url 'addeleve' %}">
                    {% csrf_token %}
                    <div class="mb-4">
                        <label for="input-noms" class="block text-sm font-bold mb-2">NOMS:</label>
                        <input type="text" id="input-noms" name="noms" class="w-full px-4 py-2 border rounded-md" required>
                    </div>
                    <div class="mb-4">
                        <label for="input-prenoms" class="block text-sm font-bold mb-2">PRENOMS:</label>
                        <input type="text" id="input-prenoms" name="prenoms" class="w-full px-4 py-2 border rounded-md" required>
                    </div>
                    <div class="mb-4">
                        <label for="input-sexe" class="block text-sm font-bold mb-2">SEXE:</label>
                        <input type="text" id="input-sexe" name="sexe" class="w-full px-4 py-2 border rounded-md" required >
                    </div>
                     <div class="mb-4">
                        <label for="input-naissance" class="block text-sm font-bold mb-2">DATE DE NAISSANCE:</label>
                        <input type="date" id="input-naissance" name="date_naissance" class="w-full px-4 py-2 border rounded-md" required>
                    </div>
                    <div class="mb-4">
                        <label for="input-quartier" class="block text-sm font-bold mb-2">QUARTIER:</label>
                        <input type="text" id="input-quartier" name="quartier" class="w-full px-4 py-2 border rounded-md" >
                    </div>
                     <div class="mb-4">
                    

                    <div class="mb-4">
                        <label for="input-classe" class="block text-sm font-bold mb-2">CLASSE:</label>
                         <select id="classe" name="classe" class="mt-1 block w-md pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">
                                       {% for salle in salles %}
                                        <option value="{{ salle.id }}">{{ salle.nom }}</option>
                                        {% endfor %}
                </select>
                        <!-- input type="text" id="input-classe" name="classe" class="w-full px-4 py-2 border rounded-md" required -->
                    </div>

                    

                        <label for="input-tel_parent" class="block text-sm font-bold mb-2">NUMERO PARENT:</label>
                        <input type="text" id="input-tel_parent" name="tel_parent" class="w-full px-4 py-2 border rounded-md" required>
                    </div>
                    <div class="flex justify-end">
                        <button type="button" id="close-modal" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded mr-2">Annuler</button>
                        <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Ajouter</button>
                    </div>
                </form>
            </div>
        </div>`;
    break;

                case 'deconnexion':
                    contentHtml = `
                        <div class="main-title">
                            <p class="fw-600">Déconnexion</p>
                        </div>
                        <form method="post" action="{% url 'deconnexion' %}" id="logout-form">
                            {% csrf_token %}
                            <button type="submit" class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">
                                Déconnexion
                            </button>
                        </form>`;
                    break;
             
                    

  }

            mainContent.innerHTML = contentHtml;
            if (content === 'emploie') {
                  attachFormSubmitEvent();
                    }

            // Gestion de l'ouverture du modal
            const openModalBtn = document.getElementById('open-modal');
            const modal = document.getElementById('modal-form');
            const closeModalBtn = document.getElementById('close-modal');

            if (openModalBtn) {
                openModalBtn.addEventListener('click', () => {
                    modal.classList.remove('hidden');
                });
            }

            if (closeModalBtn) {
                closeModalBtn.addEventListener('click', () => {
                    modal.classList.add('hidden');
                });
            }

            document.addEventListener('DOMContentLoaded', function() {

    // 1. Gestion de l'ajout d'un élève
    // ----------------------------------
    const addEleveForm = document.getElementById('add-eleve-form');
    const modalForm = document.getElementById('modal-form');
    const openModalBtn = document.getElementById('open-modal');
    const closeModalBtn = document.getElementById('close-modal');
    const tableContainer = document.getElementById('table-container'); // Tableau des élèves

    // Ouvrir le modal pour ajouter un élève
    if (openModalBtn) {
        openModalBtn.addEventListener('click', () => {
            modalForm.classList.remove('hidden');
            tableContainer.classList.add('hidden'); // Masquer le tableau
        });
    }

    // Fermer le modal et afficher le tableau des élèves
    if (closeModalBtn) {
        closeModalBtn.addEventListener('click', () => {
            modalForm.classList.add('hidden');
            tableContainer.classList.remove('hidden'); // Afficher le tableau
        });
    }

    // Soumission du formulaire pour ajouter un élève
    if (addEleveForm) {
        addEleveForm.addEventListener('submit', (event) => {
            event.preventDefault();
            fetch(addEleveForm.action, {
                method: 'POST',
                body: new FormData(addEleveForm),
                headers: {
                    'X-CSRFToken': document.querySelector('[name="csrfmiddlewaretoken"]').value
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Ajouter l'élève dans le tableau après soumission
                    const eleve = data.eleve;
                    const newRow = `
                        <tr>
                            <td>${eleve.id}</td>
                            <td>${eleve.noms}</td>
                            <td>${eleve.prenoms}</td>
                            <td>${eleve.date_naissance}</td>
                            <td>${eleve.sexe}</td>
                            <td>${eleve.quartier}</td>
                            <td>${eleve.classe}</td>
                            <td>${eleve.tel_parent}</td>
                            <td>
                                <button class="edit-btn" data-id="${eleve.id}">Modifier</button>
                                <button class="delete-btn" data-id="${eleve.id}">Supprimer</button>
                            </td>
                        </tr>
                    `;
                    document.querySelector('table tbody').insertAdjacentHTML('beforeend', newRow);
                    // Réinitialiser le formulaire, fermer le modal et afficher le tableau
                    addEleveForm.reset();
                    modalForm.classList.add('hidden');
                    tableContainer.classList.remove('hidden');
                } else {
                    alert('Erreur lors de l\'ajout de l\'élève.');
                }
            })
            .catch(error => {
                console.error('Erreur:', error);
                alert('Une erreur s\'est produite lors de l\'ajout de l\'élève.');
            });
        });
    }

    // 2. Gestion de l'ajout d'un enseignant
    // --------------------------------------
    const addEnseignantForm = document.getElementById('add-enseignant-form');
    if (addEnseignantForm) {
        addEnseignantForm.addEventListener('submit', (event) => {
            event.preventDefault();
            fetch(addEnseignantForm.action, {
                method: 'POST',
                body: new FormData(addEnseignantForm),
                headers: {
                    'X-CSRFToken': document.querySelector('[name="csrfmiddlewaretoken"]').value
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Code pour ajouter l'enseignant dans le tableau
                    const enseignant = data.enseignant;
                    const newRow = `
                        <tr>
                            <td>${enseignant.id}</td>
                            <td>${enseignant.noms}</td>
                            <td>${enseignant.prenom}</td>
                            <td>${enseignant.matiere}</td>
                            <td>${enseignant.niveau}</td>
                            <td>
                                <button class="edit-enseignant-btn" data-id="${enseignant.id}">Modifier</button>
                                <button class="delete-enseignant-btn" data-id="${enseignant.id}">Supprimer</button>
                            </td>
                        </tr>
                    `;
                    document.querySelector('table tbody').insertAdjacentHTML('beforeend', newRow);
                } else {
                    alert('Erreur lors de l\'ajout de l\'enseignant.');
                }
            })
            .catch(error => {
                console.error('Erreur:', error);
                alert('Une erreur s\'est produite lors de l\'ajout de l\'enseignant.');
            });
        });
    }

     // 3. Gestion de l'ajout d'un PARENT
    // --------------------------------------
    const addParentForm = document.getElementById('add-parent-form');
    if (addParentForm) {
        addParentForm.addEventListener('submit', (event) => {
            event.preventDefault();
            fetch(addParentForm.action, {
                method: 'POST',
                body: new FormData(addParentForm),
                headers: {
                    'X-CSRFToken': document.querySelector('[name="csrfmiddlewaretoken"]').value
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Code pour ajouter le parent dans le tableau
                    const parent = data.parent;
                    const newRow = `
                        <tr>
                            <td>${parent.id}</td>
                            <td>${parent.noms}</td>
                            <td>${parent.prenom}</td>
                            <td>${parent.profession}</td>
                            <td>${parent.nombres_enfants}</td>
                            <td>
                                <button class="edit-parent-btn" data-id="${parent.id}">Modifier</button>
                                <button class="delete-parent-btn" data-id="${parent.id}">Supprimer</button>
                            </td>
                        </tr>
                    `;
                    document.querySelector('table tbody').insertAdjacentHTML('beforeend', newRow);
                } else {
                    alert('Erreur lors de l\'ajout du parent.');
                }
            })
            .catch(error => {
                console.error('Erreur:', error);
                alert('Une erreur s\'est produite lors de l\'ajout du parent.');
            });
        });
    }

    // 4. Gestion de la déconnexion
    // -----------------------------
    const logoutForm = document.getElementById('logout-form');
    if (logoutForm) {
        logoutForm.addEventListener('submit', (event) => {
            event.preventDefault();
            fetch(logoutForm.action, {
                method: 'POST',
                headers: {
                    'X-CSRFToken': document.querySelector('[name="csrfmiddlewaretoken"]').value
                }
            })
            .then(response => {
                if (response.ok) {
                    window.location.href = "{% url 'connexion' %}"; // Redirection après déconnexion
                }
            });
        });
    }

    // 5. Gestion de la modification d'un enseignant
    // ---------------------------------------------
    function editEnseignant(id) {
        fetch(`/get_enseignant/${id}/`)
            .then(response => response.json())
            .then(data => {
                const modal = document.getElementById('modal-form');
                modal.classList.remove('hidden'); // Afficher le modal

                // Remplir le formulaire avec les données de l'enseignant
                document.getElementById('input-nom').value = data.noms;
                document.getElementById('input-prenom').value = data.prenom;
                document.getElementById('input-sexe').value = data.sexe;
                document.getElementById('input-telephone').value = data.telephone;
                document.getElementById('input-email').value = data.email;
                document.getElementById('input-matiere').value = data.matiere;
                document.getElementById('input-niveau').value = data.niveau;

                // Adapter le formulaire pour l'édition
                const form = document.getElementById('add-enseignant-form');
                form.action = `/modifier_enseignant/${id}/`;
                form.querySelector('button[type="submit"]').textContent = "Modifier";
            });
    } 

    // 5. Gestion de la suppression d'un enseignant
    // --------------------------------------------
    function deleteEnseignant(id) {
        if (confirm('Êtes-vous sûr de vouloir supprimer cet enseignant ?')) {
            fetch(`/supprimer_enseignant/${id}/`, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': document.querySelector('[name="csrfmiddlewaretoken"]').value
                }
            })
            .then(response => {
                if (response.ok) {
                    window.location.reload(); // Recharger la page après suppression
                } else {
                    alert('Erreur lors de la suppression.');
                }
            });
        }
    }

    // 6. Gestion des événements pour les boutons "Modifier" et "Supprimer"
    // --------------------------------------------------------------------
    document.querySelectorAll('.edit-enseignant-btn').forEach(button => {
        const id = button.getAttribute('data-id');
        button.addEventListener('click', () => editEnseignant(id));
    });

    document.querySelectorAll('.delete-enseignant-btn').forEach(button => {
        const id = button.getAttribute('data-id');
        button.addEventListener('click', () => deleteEnseignant(id));
    });
});  
              
// Initialisation de DataTables pour le tableau (si nécessaire)
const dataTable = document.getElementById('data-table');
if (dataTable) {
    $(dataTable).DataTable();
}

// 7. Gestion de l'ajout d'un enseignant
    // --------------------------------------
    document.addEventListener('DOMContentLoaded', () => {
    // Ouvrir le modal
    const openModalButton = document.getElementById('open-modal');
    const modalForm = document.getElementById('modal-form');
    const closeModalButton = document.getElementById('close-modal');

    openModalButton.addEventListener('click', () => {
        modalForm.classList.remove('hidden');
    });

    // Fermer le modal
    closeModalButton.addEventListener('click', () => {
        modalForm.classList.add('hidden');
    });

    // Gestion de l'ajout d'une salle
    const addSalleForm = document.getElementById('add-salle-form');
    
    if (addSalleForm) {
        addSalleForm.addEventListener('submit', (event) => {
            event.preventDefault();
            
            // Envoi de la requête POST pour ajouter une salle
            fetch(addSalleForm.action, {
                method: 'POST',
                body: new FormData(addSalleForm),
                headers: {
                    'X-CSRFToken': document.querySelector('[name="csrfmiddlewaretoken"]').value
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Ajouter la nouvelle salle dans le tableau
                    const salle = data.salle;
                    const newRow = `
                        <tr>
                            <td>${salle.id}</td>
                            <td>${salle.nom}</td>
                            <td>${salle.localisation}</td>
                            <td>${salle.effectifs}</td>
                            <td class="text-center">
                                <button class="text-yellow-500 hover:text-yellow-700" onclick="editSalle(${salle.id})">
                                    <span class="material-icons-outlined">edit</span>
                                </button>
                                <button class="text-red-500 hover:text-red-700 ml-2" onclick="deleteSalle(${salle.id})">
                                    <span class="material-icons-outlined">delete</span>
                                </button>
                            </td>
                        </tr>
                    `;
                    document.querySelector('#table-body').insertAdjacentHTML('beforeend', newRow);

                    // Fermer le modal après l'ajout
                    modalForm.classList.add('hidden');
                } else {
                    alert('Erreur lors de l\'ajout de la salle.');
                }
            })
            .catch(error => {
                console.error('Erreur:', error);
                alert('Une erreur s\'est produite lors de l\'ajout de la salle.');
            });
        });
    }

// code pour ajouter une matiere 
const addMatiereForm = document.getElementById('add-matiere-form');
    
    if (addMatiereForm) {
        addMatiereForm.addEventListener('submit', (event) => {
            event.preventDefault();
            
            // Envoi de la requête POST pour ajouter une salle
            fetch(addMatiereForm.action, {
                method: 'POST',
                body: new FormData(addMatiereForm),
                headers: {
                    'X-CSRFToken': document.querySelector('[name="csrfmiddlewaretoken"]').value
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Ajouter la nouvelle matiere dans le tableau
                    const matiere = data.matiere;
                    const newRow = `
                        <tr>
                            <td>${matiere.id}</td>
                            <td>${matiere.nom}</td>
                            <td>${matiere.coefficient}</td>
                            <td class="text-center">
                                <button class="text-yellow-500 hover:text-yellow-700" onclick="editMatiere(${matiere.id})">
                                    <span class="material-icons-outlined">edit</span>
                                </button>
                                <button class="text-red-500 hover:text-red-700 ml-2" onclick="deleteMatiere(${matiere.id})">
                                    <span class="material-icons-outlined">delete</span>
                                </button>
                            </td>
                        </tr>
                    `;
                    document.querySelector('#table-body').insertAdjacentHTML('beforeend', newRow);

                    // Fermer le modal après l'ajout
                    modalForm.classList.add('hidden');
                } else {
                    alert('Erreur lors de l\'ajout de la matiere.');
                }
            })
            .catch(error => {
                console.error('Erreur:', error);
                alert('Une erreur s\'est produite lors de l\'ajout de la matiere.');
            });
        });
    } 

});


 // Soumission du formulaire pour ajouter un élève
 if (addEleveForm) {
        addEleveForm.addEventListener('submit', (event) => {
            event.preventDefault();
            fetch(addEleveForm.action, {
                method: 'POST',
                body: new FormData(addEleveForm),
                headers: {
                    'X-CSRFToken': document.querySelector('[name="csrfmiddlewaretoken"]').value
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Ajouter l'élève dans le tableau après soumission
                    const eleve = data.eleve;
                    const newRow = `
                        <tr>
                            <td>${eleve.id}</td>
                            <td>${eleve.noms}</td>
                            <td>${eleve.prenoms}</td>
                            <td>${eleve.date_naissance}</td>
                            <td>${eleve.sexe}</td>
                            <td>${eleve.quartier}</td>
                            <td>${eleve.classe}</td>
                            <td>${eleve.tel_parent}</td>
                            <td>
                                <button class="edit-btn" data-id="${eleve.id}">Modifier</button>
                                <button class="delete-btn" data-id="${eleve.id}">Supprimer</button>
                            </td>
                        </tr>
                    `;
                    document.querySelector('table tbody').insertAdjacentHTML('beforeend', newRow);
                    // Réinitialiser le formulaire, fermer le modal et afficher le tableau
                    addEleveForm.reset();
                    modalForm.classList.add('hidden');
                    tableContainer.classList.remove('hidden');
                } else {
                    alert('Erreur lors de l\'ajout de l\'élève.');
                }
            })
            .catch(error => {
                console.error('Erreur:', error);
                alert('Une erreur s\'est produite lors de l\'ajout de l\'élève.');
            });
        });
    }

   
// Fonction pour la recherche d'élèves dans le tableau
// ✅ Fonction de filtrage des élèves
document.getElementById("search").addEventListener("input", function () {
    let searchValue = this.value.toLowerCase();
    let tableRows = document.querySelectorAll("#table-container tbody tr");

    tableRows.forEach(row => {
        let rowText = row.innerText.toLowerCase();
        if (rowText.includes(searchValue)) {
            row.style.display = ""; // Afficher la ligne si elle correspond à la recherche
        } else {
            row.style.display = "none"; // Masquer sinon
        }
    });
});


});
    });
});

// code pour gerer l'emploie de temp
document.addEventListener("DOMContentLoaded", function () {
    document.body.addEventListener("change", function (event) {
        if (event.target && event.target.id === "niveau") {
            const niveauSelect = event.target;
            const salleSelect = document.getElementById("salle");
            const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;

            if (!niveauSelect || !salleSelect) {
                console.error("❌ Sélecteurs non trouvés !");
                return;
            }

            const niveauId = niveauSelect.value;
            console.log("🔹 Niveau sélectionné :", niveauId);

            if (!niveauId) return;
            const gestionemploieUrl = "{% url 'filtrer_salles_par_niveau' %}";
            fetch(gestionemploieUrl, {
                method: 'POST',
                body: new URLSearchParams({ niveau: niveauId }),
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'X-CSRFToken': csrfToken
                }
            })
            .then(response => response.json())
            .then(data => {
                console.log("📌 Salles reçues :", data.salles);

                // Vider le select des salles
                salleSelect.innerHTML = `<option value="">Sélectionnez une salle</option>`;

                // Ajouter les nouvelles salles filtrées
                if (data.salles && data.salles.length > 0) {
                    data.salles.forEach(salle => {
                        let option = document.createElement("option");
                        option.value = salle.id;
                        option.textContent = salle.nom;
                        salleSelect.appendChild(option);
                    });
                } else {
                    console.warn("⚠️ Aucune salle trouvée !");
                }
            })
            .catch(error => console.error("❌ Erreur lors du chargement des salles :", error));
        }
    });
});
// fin code emploie


function attachFormSubmitEvent() {
    const emploiForm = document.getElementById('emploi-form');
    
    if (emploiForm) {
        emploiForm.addEventListener('submit', function (event) {
            event.preventDefault(); // Empêche le rechargement de la page

            const formData = new FormData(emploiForm);
            const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
            const emploieUrl = "{% url 'emploi_temps_view' %}";
            fetch(emploieUrl, {
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': csrfToken
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.emploi_du_temps) {
                    // Masquer le formulaire
                    document.getElementById("form-container").classList.add("hidden-form");

                    // Afficher le tableau dynamique
                    afficherTableauEmploi(data);
                } else {
                    alert("❌ Erreur : Impossible de charger l'emploi du temps !");
                }
            })
            .catch(error => console.error("❌ Erreur lors du chargement de l'emploi du temps :", error));
        });
    }
}





// code apres formulaire emploie
function afficherTableauEmploi(data) {
    const container = document.getElementById("emploi-table-container");

    if (!container) {
        console.error("❌ Erreur : Le conteneur 'emploi-table-container' est introuvable !");
        return; // Arrête l'exécution si l'élément n'existe pas
    }

    let tableHtml = `
        <div class="flex justify-between mb-4">
            <button id="saveButton" onclick="attachSaveButtonEvent()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Enregistrer</button>
            <button id="editButton" class="bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600">Modifier</button>
            <button id="pdfButton" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">PDF</button>
        </div>
        <table id="emploiTable" class="min-w-full bg-white border">
            <thead>
                <tr class="bg-gray-100">
                    <th>HEURE / JOURS</th>
                    <th>LUNDI</th>
                    <th>MARDI</th>
                    <th>MERCREDI</th>
                    <th>JEUDI</th>
                    <th>VENDREDI</th>
                    <th>SAMEDI</th>
                </tr>
            </thead>
            <tbody>`;

    const heures = [
        "7h30 - 8h30", "8h30 - 9h30", "9h30 - 10h30",
        "10h30 - 11h30", "11h30 - 12h30", "12h30 - 13h30",
        "13h30 - 14h30", "14h30 - 15h30", "15h30 - 16h30"
    ];
    const jours = ["Lundi", "Mardi", "Mercredi", "Jeudi", "Vendredi", "Samedi"];

    heures.forEach(heure => {
        tableHtml += `<tr><td class="text-center font-bold">${heure}</td>`;

        jours.forEach(jour => {
            let matiere = data.emploi_du_temps[jour][heure] || "";
            tableHtml += `<td contenteditable="true" class="text-center border p-2">${matiere}</td>`;
        });

        tableHtml += `</tr>`;
    });

    tableHtml += `</tbody></table>`;

    // Insérer le tableau dans le conteneur
    container.innerHTML = tableHtml;
}

// fin code

// code pour add un emploie de temp
function attachSaveButtonEvent() {
    document.getElementById("saveButton").addEventListener("click", function () {
        console.log("✅ Bouton 'Enregistrer' cliqué !");
        
        let emploiData = [];
        const tableRows = document.querySelectorAll("#emploiTable tbody tr");

        tableRows.forEach(row => {
            const heure = row.cells[0].textContent.trim(); // Heure dans la première colonne

            ["Lundi", "Mardi", "Mercredi", "Jeudi", "Vendredi", "Samedi"].forEach((jour, index) => {
                let matiere = row.cells[index + 1].textContent.trim(); // Matière dans les cellules suivantes

                if (matiere) {  // On enregistre seulement si une matière est renseignée
                    emploiData.push({
                        jour: jour,
                        heure: heure,
                        matiere: matiere,
                        salle: document.getElementById("salle").value  // Récupère la salle sélectionnée
                    });
                }
            });
        });

        let formData = { emploi_du_temps: emploiData };
        console.log("📌 Données envoyées :", formData);
        const addemploieUrl = "{% url 'add_emploi_temps' %}";
        fetch(addemploieUrl, {  // URL de l'endpoint Django
            method: "POST",
            body: JSON.stringify(formData),
            headers: {
                "Content-Type": "application/json",
                "X-CSRFToken": document.querySelector('[name=csrfmiddlewaretoken]').value
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert("✅ " + data.message); // Affiche un message de succès
            location.reload(); // Recharge la page après l'enregistrement
            } else {
                alert("❌ Erreur lors de l'enregistrement !");
            }
        })
        .catch(error => {
            console.error("❌ Erreur réseau :", error);
            alert("Erreur de connexion avec le serveur !");
        });
    });
}


// fin code pour save un emploie de temp




    </script>
     
</body>

</html>